@Aggregation(pipeline = {
        "{$lookup: {"
            + "from: 'connectivity_type_version',"
            + "let: {"
                + "typeName: '$type_name',"
                + "uniquePrefKey: '$unique_pref_key'"
            + "},"
            + "pipeline: ["
                + "{$match: {"
                    + "$expr: {"
                        + "$and: ["
                            + "{$eq: ['$type_name', '$$typeName']},"
                            + "{$eq: ['$unique_pref_key', '$$uniquePrefKey']}"
                        + "]"
                    + "}"
                + "}}"
            + "],"
            + "as: 'b'"
        + "}},"
        + "{$match: {b: {$ne: []}}},"
        + "{$replaceRoot: {newRoot: '$a'}}"
    })
