import openpyxl

# Load the first Excel sheet
wb1 = openpyxl.load_workbook('sheet1.xlsx')
sheet1 = wb1.active

# Load the second Excel sheet
wb2 = openpyxl.load_workbook('sheet2.xlsx')
sheet2 = wb2.active

# Create a new workbook for the third sheet
wb3 = openpyxl.Workbook()
sheet3 = wb3.active

# Copy the headers from the first sheet to the third sheet
for column in range(1, sheet1.max_column + 1):
    cell = sheet1.cell(row=1, column=column)
    sheet3.cell(row=1, column=column).value = cell.value

# Copy the data from both sheets to the third sheet
for row in range(2, sheet1.max_row + 1):
    # Copy data from sheet1
    for column in range(1, sheet1.max_column + 1):
        cell = sheet1.cell(row=row, column=column)
        sheet3.cell(row=row, column=column).value = cell.value

    # Copy data from sheet2 and highlight the cells in sheet3
    for column in range(1, sheet2.max_column + 1):
        cell = sheet2.cell(row=row, column=column)
        sheet3.cell(row=row, column=column).value = cell.value
        sheet3.cell(row=row, column=column).fill = openpyxl.styles.PatternFill(
            fgColor='FFFF00'
        )

# Save the third sheet to a new Excel file
wb3.save('merged_sheet.xlsx')
